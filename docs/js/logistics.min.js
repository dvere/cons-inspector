var url="/consignments/",fields=["tracking_number","requested_route","consolidation_id","location","delivery_address_type","package_type","status","package_type"],data={q:"collected:SW",count:1e3,client_id:11270,fields:fields.join()};const cStatus=["RECEIVED SC","COLLECTED","ROUTED","RECONCILED","DELIVERED"];function showEvents(e){var t=url+e+"/events",n=$("<div>",{id:"cEvents"}),s=$("<div>",{class:"events-header"});$.each(["Timestamp","SC","Event","User"],function(e,t){$("<div>",{class:"events-header-item",text:t}).appendTo(s)}),$("#cAudits").empty(),$("#cAudits").append(n),$("#cEvents").append(s),$.getJSON(t,function(e){$.each(e,function(e,t){var s=$("<div>",{class:"event"});t.service_centre=t.service_centre||{code:"NA"},t.user=t.user||{username:"NA"},$("<div>",{class:"event-item",text:t.timestamp}).appendTo(s),$("<div>",{class:"event-item",text:t.service_centre.code}).appendTo(s),$("<div>",{class:"event-item",text:t.tracking_code.code}).appendTo(s),$("<div>",{class:"event-item",text:t.user.username}).appendTo(s),s.appendTo(n)}),$("#cAudits").fadeIn()}).fail(function(){console.log("Events Request Failed")})}function getCollectedCons(){var e=$("<div>",{class:"consignments-header"});$.each(["Traking No","Type","Route","Cons. Id","Location","Status"],function(t,n){$("<div>",{class:"consignments-header-item",text:n}).appendTo(e)}),$("#cConsignments").empty(),$("#cConsignments").append(e),data.received_at=$("#cDate").val(),$.getJSON(url,data,function(e){$.each(e,function(e,t){var n=$("#cStatus").val()||"RECEIVED SC";if("SWINDON"===t.location&&t.status===n){var s=$("<div>",{class:"consignment"});$("<div>",{class:"consignment-item",text:t.tracking_number,onclick:"showEvents("+t.id+")",id:t.id}).appendTo(s),$("<div>",{class:"consignment-item",text:t.package_type}).appendTo(s),$("<div>",{class:"consignment-item",text:t.requested_route}).appendTo(s),$("<div>",{class:"consignment-item",text:t.consolidation_id}).appendTo(s),$("<div>",{class:"consignment-item",text:t.location}).appendTo(s),$("<div>",{class:"consignment-item",text:t.status}).appendTo(s),$("#cConsignments").append(s)}})}).fail(function(){console.log("Consignments Request Failed")})}function addPartsToDOM(){$("<link>",{rel:"stylesheet",href:"https://dvere.github.io/cons-inspector/css/logistics.min.css?v="+$.now()}).appendTo($("head")),$("div.page-content").remove(),$("#cInsert").remove();var e=$("<select>",{id:"cStatus"});$.each(cStatus,function(t,n){$("<option>",{value:n,text:n}).appendTo(e)});var t=$("<div>",{id:"cForm"}).append($("<input>",{id:"cDate",type:"date"})).append(e).append($("<button>",{id:"cButton",text:"Lookup Collections",onclick:"getCollectedCons()"})),n=$("<div>",{id:"cInsert"}).append(t).append($("<div>",{id:"cConsignments"})).append($("<div>",{id:"cAudits"}));$("#breadcrumbs").after(n),$("#cAudits").click(function(){$(this).fadeOut()})}$.when($.ready).then(function(){addPartsToDOM()});
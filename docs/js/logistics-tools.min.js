let scMain=(t,e)=>{let n={},s=Number(t.replace(/\D/g,""));n.oldContainer=t,n.newContainer=e,n.consignments=[],$.getJSON("/trunkcontainers/"+s+"/events").done(t=>{let e=[];return $.each(t,(t,n)=>{let s=n.description.split(" ")[1];s.match(/^PCS[0-9]{9}$/)&&e.push(s)}),e}).then(s=>{0!==s.length?$.each(s,(t,s)=>{$.post("/trunkcontainers/"+e+"/scan/"+s).done(t=>{let e={barcode:s,status:t.status};n.consignments.push(e)})}):(n.error=1,n.errormessage="Could not get records for "+t),$("#lt_results").text(JSON.stringify(n,void 0,2))})},ciMain=t=>{let e="/consignments/";$.getJSON(e,t).done(t=>{t.length>0?$("#lt_results").text(JSON.stringify(t,void 0,2)):$("#lt_results").text("Lookup returned no consignments.")}).fail((t,e,n)=>{$("#lt_results").text(e),console.log("Ooops, CI Error: "+n+"\n"+t)})};function addPartsToDOM(){var t;$("<link>",{id:"lt-style",rel:"stylesheet",href:"https://dvere.github.io/logistics-tools/"+"css/logistics-tools.min.css?v="+$.now()}).appendTo($("head"));var e=$("<div>",{id:"lt_container"}).append($("<button>",{class:"ltButton",text:"Consignments Inspector"}).click(()=>{$(".lt-tab").hide(),$("#ciForm").show()})).append($("<button>",{class:"ltButton",text:"Auto Containers"})).append($("<button>",{class:"ltButton",text:"Swap Containers"}).click(()=>{$(".lt-tab").hide(),$("#scForm").show(),$("#old_ctr").focus()})).append($("<div>",{id:"lt_insert"})).append($("<div>",{id:"lt_results"}));$("div.breadcrumbs").hide(),$("div.page-content > div > div").empty().append(e);let n,s={required:"required",pattern:"(CSTC|OOC)[0-9]{8}"},i=$("<div>",{id:"scForm",class:"lt-tab"}).append($("<input>",{id:"sc_old"}).attr(s)).append($("<input>",{id:"sc_new"}).attr(s)).append($("<button>",{id:"sc_btn"}).text("Move Records"));$("#lt_insert").append(i),$("#sc_btn").click(()=>{let t=$("#sc_old").val().trim(),e=$("#sc_new").val().trim();scMain(t,e)});let o=["RECEIVED SC","COLLECTED","ROUTED","RECONCILED"],a=$("<div>",{id:"ciForm"}).append($("<input>",{id:"ci_date",type:"date"})).append($("<select>",{id:"ci_status"})).append($("<button>",{id:"ci_btn",text:"Look up collections"}));$("#lt_insert").append(a),$.each(o,(t,e)=>$("<option>",{value:e,text:e}).appendTo($("#ci_status"))),$("#ci_btn").click(()=>{let t,e={q:"collected:SW",count:1e3,client_id:11270,fields:["tracking_number","requested_route","consolidation_id","location","delivery_address_type","package_type","status"].join(),received_at:$("#ci_date").val(),status:$("#ci_status").val(),location:"SWINDON"};ciMain(e)})}$.when($.ready).then((function(){addPartsToDOM()}));